import React from 'react'; import { fireEvent, render } from '@testing-library/react-native'; import TabScreen from '@/app/(tabs)/index'; import { renderWithProviders, mockApi } from '../utils/test-utils'; describe('Tab Screen', () => { it('renders loading skeleton initially', () => { const { getByTestId } = renderWithProviders(<TabScreen />); expect(getByTestId('skeleton-loader')).toBeTruthy(); }); it('renders data after successful fetch', async () => { mockApi({ data: [{ id: 1, name: 'Item 1' }] }); const { findByText } = renderWithProviders(<TabScreen />); expect(await findByText('Item 1')).toBeTruthy(); }); it('renders empty state when no data', async () => { mockApi({ data: [] }); const { findByText } = renderWithProviders(<TabScreen />); expect(await findByText('No items available')).toBeTruthy(); }); it('renders error state when fetch fails', async () => { mockApi(Promise.reject(new Error('Fetch error'))); const { findByText } = renderWithProviders(<TabScreen />); expect(await findByText('Error loading data')).toBeTruthy(); }); it('pull-to-refresh triggers refetch', () => { const { getByTestId } = renderWithProviders(<TabScreen />); fireEvent(getByTestId('list'), 'refresh'); expect(mockApi).toHaveBeenCalledTimes(2); }); it('navigation to detail screen works', () => { const { getByText } = renderWithProviders(<TabScreen />); fireEvent.press(getByText('Item 1')); expect(useRouter().push).toHaveBeenCalledWith('/detail/1'); }); });